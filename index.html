<!doctype html>
<html lang="en">
<meta charset='utf-8'>

<link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/css/bootstrap-datetimepicker.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.7.3/css/bootstrap-select.min.css">

<script src='https://code.jquery.com/jquery-2.1.4.min.js'></script>
<script src='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/js/bootstrap-datetimepicker.min.js'></script>
<script src="https://cdn.firebase.com/js/client/2.2.9/firebase.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.7.3/js/bootstrap-select.min.js"></script>

<style>
body {
  font-family: Arial, Helvetica, sans-serif;
  padding:0;
  margin:0;
  vertical-align:center;
  text-align:center;
}
h1 {
  margin:0;
  line-height: 150px;
  font-family: 'Roboto Slab';
}
</style>

<div style="height:150px; background-color:White; color:Navy">
  <h1>Water Wizard</h1>
</div>

<div style="height:230px; padding:40px;background-color:Navy; color:white">
  <p>Upcoming watering time: <b>7:00 pm (in 3 hours)</b></p>
  <a href>Skip this time</a><br><br><br>
  <button class="btn btn-default btn-lg">Water Now!</button>
</div>

<div style="height:200px; margin: 20px; ">

  <div style="width:50%; height: 200px; float:left">
    <div class="panel panel-default" style="height:100%; margin:10px 15px 10px 10px;">
      <div class="panel-body">

      <p><font size="5"> Temperature Sensor: </font>
      <br>
      </p>
      <p><font size="9">
      <span id="temp"></span></font></p>
      </br>

      </div>
    </div>
  </div>

  <div style="width:50%; height: 200px; float:left">
    <div class="panel panel-default" style="height:100%; margin:10px 10px 10px 15px;">
      <div class="panel-body">
      <p><font size="5">  Humidity: </font>
          <br>
          </p>
          <p><font size="9">
        <span id="humidity"></span></span></font></p>
      </br>
      </div>
    </div>
  </div>

</div>

<div style="height:20px;">

</div>

<iframe id="forecast_embed" type="text/html" frameborder="0" height="245" width="100%" src="http://forecast.io/embed/#lat=42.2828&lon=-83.7347&name=University of Michigan"> </iframe>


<div style="background-color:#99CCFF">
  <h1>Watering Times</h1>

  <select class="selectpicker">
    <optgroup>
      <option>Water the plants</option>
      <option>Give water to the dog</option>
    </optgroup>
    <optgroup>
      <option>New Profile...</option>
    </optgroup>
  </select>
  <br><br>
  <a href>Edit Name</a> |
  <a href>Delete</a>

  <br><br>
  <div style="background-color:white; width: 70%; margin: 0 auto;">
    <div style="height: 200px;">
      asdf
    </div>
  </div>
</div>

<table id="schedules" border="1">
  <tr>
    <td>Repeat?</td>
    <td>Time</td>
    <td>Days</td>
    <td>Frequency Timer</td>
    <td>Do not repeat if</td>
    <td>Flow Duration</td>
    <td>Modify flow if</td>
    <td>Date</td>
    <td></td>
  </tr>
  <tr>
    <td>
      <input type="checkbox">
    </td>
    <td><input type="text" class="needs-timepick" value=""></td>
    <td>
      <input type="checkbox" value="Sunday">S
      <input type="checkbox" value="Monday">M
      <input type="checkbox" value="Tuesday">T
      <input type="checkbox" value="Wednesday">W
      <input type="checkbox" value="Thursday">Th
      <input type="checkbox" value="Friday">F
      <input type="checkbox" value="Saturday">Sa
    </td>
    <td>Every <input type="number" style="width:30px">
      <select>
        <option value="volvo">hours</option>
        <option value="saab">minutes</option>
        <option value="saab">seconds</option>
      </select>
    </td>
    <td>
      <input type="checkbox" value="Saturday">Rain within <input type="number" style="width:30px"> day(s)
      <br>
      <input type="checkbox" value="Saturday">Hot
    </td>
    <td>
      <input type="number" style="width:30px">
      <select>
        <option value="volvo">sec</option>
        <option value="saab">min</option>
        <option value="saab">hrs</option>
      </select>
    </td>
    <td>
      <input type="checkbox">Temp over <input type="number" style="width:30px">
      &deg;F
    </td>
    <td></td>
    <td><a href>x</a></td>
  </tr>
</table>

<br><br>
Timestamp: <span id="tstamp"></span>

<form action="https://api.particle.io/v1/devices/54ff6a066672524819361267/led?access_token=22de5c62f0253e4cabad74d98664301dabaa4859" method="POST">
  <h3>Manual Control</h3>
    <input type="radio" name="args" value="on">Open
    <br>
    <input type="radio" name="args" value="off">Close
    <br>
    <br>
    <input type="submit" value="Go!">
  </form>

  <h3>Water Used: 20 L the past week</h3>
  <h3>Water History:</h3>
  <ul>
    <li>Watered for 1 minute at 7:00pm yesterday</li>
    <li>Watered for 1 minute at 7:00pm Thursday 9/10/15</li>
    <a href>More...</a>
    <br>[Visualization?]
  </ul>

  <h3>Temperature History:</h3>

  <h3>Humidity History:</h3>

  <h3>Combined Graph</h3>

<script>
  $(function() {
    $('.selectpicker').selectpicker();
  });
  var myFirebaseRef = new Firebase("https://mhacks6.firebaseio.com/");
  var tempRef = myFirebaseRef.child("curr_temp");
  var humidityRef = myFirebaseRef.child("curr_humidity");

  updateSensorData();

  function updateSensorData() {
    document.getElementById("temp").innerHTML = "Waiting for data...";
    document.getElementById("humidity").innerHTML = "Waiting for data...";
    document.getElementById("tstamp").innerHTML ="Waiting for data...";

    window.setInterval(function() {

      var deviceID = "54ff6a066672524819361267";
      var accessToken = "22de5c62f0253e4cabad74d98664301dabaa4859";
      var varName1 = "temperature";
      var varName2 = "humidity";

      requestURL = "https://api.particle.io/v1/devices/" + deviceID + "/" + varName1 + "/?access_token=" + accessToken;
      $.getJSON(requestURL, function(json) {
               document.getElementById("temp").innerHTML = parseFloat(json.result).toFixed(1) + "&deg; F";
               tempRef.set(json.result);
               });
      requestURL2 = "https://api.particle.io/v1/devices/" + deviceID + "/" + varName2 + "/?access_token=" + accessToken;
      $.getJSON(requestURL2, function(json) {
               document.getElementById("humidity").innerHTML = parseFloat(json.result).toFixed(1) + "%";
               humidityRef.set(json.result);
               document.getElementById("tstamp").innerHTML = json.coreInfo.last_heard;
               });
    }, 6000);
  }

</script>

</html>
